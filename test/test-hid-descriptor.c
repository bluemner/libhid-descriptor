#include "hid-descriptor.h"
#include <stdio.h>
#include <assert.h>
void test_blade(){
  printf("Starting Blade Test\n");
  libhid_report_descriptor_t blade_raw = {
    .size = 665,
    .value  ={
        0x05,0x01,0x09,0x02,0xa1,0x01,0x85,0x02,0x09,0x01,
        0xa1,0x00,0x05,0x09,0x19,0x01,0x29,0x02,0x15,0x00,
        0x25,0x01,0x75,0x01,0x95,0x02,0x81,0x02,0x95,0x06,
        0x81,0x01,0x05,0x01,0x09,0x30,0x09,0x31,0x15,0x81,
        0x25,0x7f,0x75,0x08,0x95,0x02,0x81,0x06,0xc0,0xc0,
        0x05,0x0d,0x09,0x05,0xa1,0x01,0x85,0x03,0x05,0x0d,
        0x09,0x22,0xa1,0x02,0x15,0x00,0x25,0x01,0x09,0x47,
        0x09,0x42,0x95,0x02,0x75,0x01,0x81,0x02,0x95,0x01,
        0x75,0x03,0x25,0x05,0x09,0x51,0x81,0x02,0x75,0x01,
        0x95,0x03,0x81,0x03,0x05,0x01,0x15,0x00,0x26,0x0b,
        0x05,0x75,0x10,0x55,0x0e,0x65,0x11,0x09,0x30,0x35,
        0x00,0x46,0x33,0x04,0x95,0x01,0x81,0x02,0x46,0xca,
        0x02,0x26,0x59,0x03,0x09,0x31,0x81,0x02,0xc0,0x05,
        0x0d,0x09,0x22,0xa1,0x02,0x15,0x00,0x25,0x01,0x09,
        0x47,0x09,0x42,0x95,0x02,0x75,0x01,0x81,0x02,0x95,
        0x01,0x75,0x03,0x25,0x05,0x09,0x51,0x81,0x02,0x75,
        0x01,0x95,0x03,0x81,0x03,0x05,0x01,0x15,0x00,0x26,
        0x0b,0x05,0x75,0x10,0x55,0x0e,0x65,0x11,0x09,0x30,
        0x35,0x00,0x46,0x33,0x04,0x95,0x01,0x81,0x02,0x46,
        0xca,0x02,0x26,0x59,0x03,0x09,0x31,0x81,0x02,0xc0,
        0x05,0x0d,0x09,0x22,0xa1,0x02,0x15,0x00,0x25,0x01,
        0x09,0x47,0x09,0x42,0x95,0x02,0x75,0x01,0x81,0x02,
        0x95,0x01,0x75,0x03,0x25,0x05,0x09,0x51,0x81,0x02,
        0x75,0x01,0x95,0x03,0x81,0x03,0x05,0x01,0x15,0x00,
        0x26,0x0b,0x05,0x75,0x10,0x55,0x0e,0x65,0x11,0x09,
        0x30,0x35,0x00,0x46,0x33,0x04,0x95,0x01,0x81,0x02,
        0x46,0xca,0x02,0x26,0x59,0x03,0x09,0x31,0x81,0x02,
        0xc0,0x05,0x0d,0x09,0x22,0xa1,0x02,0x15,0x00,0x25,
        0x01,0x09,0x47,0x09,0x42,0x95,0x02,0x75,0x01,0x81,
        0x02,0x95,0x01,0x75,0x03,0x25,0x05,0x09,0x51,0x81,
        0x02,0x75,0x01,0x95,0x03,0x81,0x03,0x05,0x01,0x15,
        0x00,0x26,0x0b,0x05,0x75,0x10,0x55,0x0e,0x65,0x11,
        0x09,0x30,0x35,0x00,0x46,0x33,0x04,0x95,0x01,0x81,
        0x02,0x46,0xca,0x02,0x26,0x59,0x03,0x09,0x31,0x81,
        0x02,0xc0,0x05,0x0d,0x09,0x22,0xa1,0x02,0x15,0x00,
        0x25,0x01,0x09,0x47,0x09,0x42,0x95,0x02,0x75,0x01,
        0x81,0x02,0x95,0x01,0x75,0x03,0x25,0x05,0x09,0x51,
        0x81,0x02,0x75,0x01,0x95,0x03,0x81,0x03,0x05,0x01,
        0x15,0x00,0x26,0x0b,0x05,0x75,0x10,0x55,0x0e,0x65,
        0x11,0x09,0x30,0x35,0x00,0x46,0x33,0x04,0x95,0x01,
        0x81,0x02,0x46,0xca,0x02,0x26,0x59,0x03,0x09,0x31,
        0x81,0x02,0xc0,0x05,0x0d,0x55,0x0c,0x66,0x01,0x10,
        0x47,0xff,0xff,0x00,0x00,0x27,0xff,0xff,0x00,0x00,
        0x75,0x10,0x95,0x01,0x09,0x56,0x81,0x02,0x09,0x54,
        0x25,0x7f,0x95,0x01,0x75,0x08,0x81,0x02,0x05,0x09,
        0x09,0x01,0x25,0x01,0x75,0x01,0x95,0x01,0x81,0x02,
        0x95,0x07,0x81,0x03,0x05,0x0d,0x85,0x08,0x09,0x55,
        0x09,0x59,0x75,0x04,0x95,0x02,0x25,0x0f,0xb1,0x02,
        0x85,0x0d,0x09,0x60,0x75,0x01,0x95,0x01,0x15,0x00,
        0x25,0x01,0xb1,0x02,0x95,0x07,0xb1,0x03,0x85,0x07,
        0x06,0x00,0xff,0x09,0xc5,0x15,0x00,0x26,0xff,0x00,
        0x75,0x08,0x96,0x00,0x01,0xb1,0x02,0xc0,0x05,0x0d,
        0x09,0x0e,0xa1,0x01,0x85,0x04,0x09,0x22,0xa1,0x02,
        0x09,0x52,0x15,0x00,0x25,0x0a,0x75,0x08,0x95,0x01,
        0xb1,0x02,0xc0,0x09,0x22,0xa1,0x00,0x85,0x06,0x09,
        0x57,0x09,0x58,0x75,0x01,0x95,0x02,0x25,0x01,0xb1,
        0x02,0x95,0x06,0xb1,0x03,0xc0,0xc0,0x06,0x00,0xff,
        0x09,0x01,0xa1,0x01,0x85,0x09,0x09,0x02,0x15,0x00,
        0x26,0xff,0x00,0x75,0x08,0x95,0x14,0x91,0x02,0x85,
        0x0a,0x09,0x03,0x15,0x00,0x26,0xff,0x00,0x75,0x08,
        0x95,0x14,0x91,0x02,0x85,0x0b,0x09,0x04,0x15,0x00,
        0x26,0xff,0x00,0x75,0x08,0x95,0x3d,0x81,0x02,0x85,
        0x0c,0x09,0x05,0x15,0x00,0x26,0xff,0x00,0x75,0x08,
        0x95,0x3d,0x81,0x02,0x85,0x0f,0x09,0x06,0x15,0x00,
        0x26,0xff,0x00,0x75,0x08,0x95,0x03,0xb1,0x02,0x85,
        0x0e,0x09,0x07,0x15,0x00,0x26,0xff,0x00,0x75,0x08,
        0x95,0x01,0xb1,0x02,0xc0
    }
  };

  int16_t cnt = libhid_count(&blade_raw);
  printf("Count: %d\n",cnt);
  hid_descriptor_t descriptor;
  libhid_descriptor_create(&blade_raw,&descriptor);
  
  assert( (uint16_t)cnt == descriptor.items_size && "Check descriptor item size" );
  
  libhid_descriptor_print(&descriptor);
  libhid_descriptor_destroy(&descriptor);

}
void test_g600() {
  libhid_report_descriptor_t g600_raw = {
    .size = 135,
    .value = {
        0x05,0x01,0x09,0x06,0xa1,0x01,0x85,0x01,0x05,0x07,
        0x19,0xe0,0x29,0xe7,0x15,0x00,0x25,0x01,0x75,0x01,
        0x95,0x08,0x81,0x02,0x75,0x08,0x95,0x05,0x15,0x00,
        0x26,0xa4,0x00,0x19,0x00,0x2a,0xa4,0x00,0x81,0x00,
        0xc0,0x06,0x80,0xff,0x09,0x80,0xa1,0x01,0x85,0x80,
        0x09,0x80,0x75,0x08,0x95,0x05,0x81,0x02,0x85,0xf6,
        0x09,0xf6,0x75,0x08,0x95,0x07,0x81,0x02,0x85,0xf0,
        0x09,0xf0,0x95,0x03,0xb1,0x02,0x85,0xf1,0x09,0xf1,
        0x95,0x07,0xb1,0x02,0x85,0xf2,0x09,0xf2,0x95,0x04,
        0xb1,0x02,0x85,0xf3,0x09,0xf3,0x95,0x99,0xb1,0x02,
        0x85,0xf4,0x09,0xf4,0x95,0x99,0xb1,0x02,0x85,0xf5,
        0x09,0xf5,0x95,0x99,0xb1,0x02,0x85,0xf6,0x09,0xf6,
        0x95,0x07,0xb1,0x02,0x85,0xf7,0x09,0xf7,0x75,0x08,
        0x95,0x1f,0x81,0x02,0xc0
    }
  };
  
  int16_t cnt = libhid_count(&g600_raw);
  printf("Count: %d\n",cnt);
  hid_descriptor_t descriptor;

  libhid_descriptor_create(&g600_raw,&descriptor);
  
  assert( (uint8_t)cnt == descriptor.items_size && "Check descriptor item size" );
  libhid_descriptor_print(&descriptor);
  libhid_descriptor_destroy(&descriptor);
}

int main(){
  test_g600();
  test_blade();
  return 0;
}